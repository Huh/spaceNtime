"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
tab <- a_lookup_fn(df)
d <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(df,
countcol = "count",
samp = 3600,
samplength = 10,
camareas = tab,
datelim = d,
A = 150000)
ste_estN_fn(dat.ste)
a
tab
tab <- a_lookup_fn(df)
knitr::kable(tab)
install.packages("stringi")
install.packages("stringi")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("stringi")
rmarkdown::render("vignettes/tte-ste-is.Rmd")
uninstall.packages("stringi")
library(installr)
install.packages("installr")
installr::uninstall.packages("stringi")
install.packages("stringi")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
devtools::install_github("annam21/TTE.STE.IS")
library(TTE.STE.IS)
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
knitr::kable(df)
lu <- a_lookup_fn(df)
knitr::kable(tab)
lu <- TTE.STE.IS::a_lookup_fn(df)
knitr::kable(tab)
devtools::load_all(".")
vignette(TTE.STE.IS)
vignette("TTE.STE.IS")
vignette("tte.ste.is")
vignette("tte.ste.is.Rmd")
vignette(package = "TTE.STE.IS")
devtools::use_vignette("my-vignette")
devtools::load_all(".")
vignette(package = "TTE.STE.IS")
devtools::build()
vignette(package = "TTE.STE.IS")
devtools::load_all(".")
vignette(package = "TTE.STE.IS")
devtools::install_github("annam21/TTE.STE.IS", build_vignettes = T)
library(TTE.STE.IS)
vignette(package = "TTE.STE.IS")
library(TTE.STE.IS)
library(TTE.STE.IS)
vignette(package = "TTE.STE.IS")
devtools::load_all(".")
vignette(package = "TTE.STE.IS")
help(package = "TTE.STE.IS")
help(package = "TTE.STE.IS", help_type = "html")
browseVignettes("TTE.STE.IS")
devtools::load_all(".")
browseVignettes("TTE.STE.IS")
help(package = "TTE.STE.IS", help_type = "html")
help(package = "TTE.STE.IS", help_type = "html")
devtools::build_vignettes()
vignettes(package = "TTE.STE.IS")
vignette(package = "TTE.STE.IS")
?tte.ste.is
devtools::install(build_vignettes = T)
vignette(TTE.STE.IS)
vignette("TTE.STE.IS")
vignette(packate = "TTE.STE.IS")
vignette(package = "TTE.STE.IS")
vignette("tte-ste-is")
vignette("tte-ste-is")
vignette(package = "TTE.STE.IS")
devtools::install(build_vignettes = T)
vignette(package = "TTE.STE.IS")
devtools::load_all(".")
vignette(package = "TTE.STE.IS")
vignette(package = "TTE.STE.IS")
vignette("tte-ste-is")
devtools::load_all(".")
devtools::install(build_vignettes = T)
vignette("tte-ste-is")
vignette(package = "TTE-STE-IS")
devtools::install_github("annam21/TTE.STE.IS")
vignette(package = "TTE-STE-IS")
vignette(package = "TTE.STE.IS")
devtools::install_github("annam21/TTE.STE.IS", build_vignettes = T)
browseVignettes("TTE.STE.IS")
browseVignettes()
devtools::install(build_vignettes = T)
browseVignettes("TTE.STE.IS")
devtools::build_vignettes()
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
devtools::load_all(".")
?ste_estN_n
?ste_estN_fn
devtools::load_all(".")
?ste_estN_fn
devtools::load_all(".")
?ste_data_fn
library(TTE.STE.IS)
?ste_data_fn
devtools::load_all(".")
?ste_data_fn
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(TTE.STE.IS)
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
lu <- a_lookup_fn(df)
tab <- a_lookup_fn(df)
d <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d)
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(x = df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
devtools::install(build_vignettes = T)
devtools::install(build_vignettes = T)
devtools::install(build_vignettes = T)
devtools::install(build_vignettes = T)
devtools::load_all(".")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
library(TTE.STE.IS)
browseVignettes("TTE.STE.IS")
devtools::build_vignettes()
library(TTE.STE.IS)
browseVignettes("TTE.STE.IS")
devtools::build_vignettes()
browseVignettes("TTE.STE.IS")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
df
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 12:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 3, 2))
df
devtools::load_all(".")
df
df <- data.frame(cam = c(1,1,2,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 12:00:00",
"2016-01-03 16:53:42",
"2016-01-03 12:00:00"),
tz = "GMT"),
a = c(850, 850, 1100, 1100,1100),
count = c(1, 0, 3, 2,1))
tab <- a_lookup_fn(df)
tab
d <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
devtools::load_all(".")
df <- data.frame(cam = c(1,1,2,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 12:00:00",
"2016-01-03 16:53:42",
"2016-01-03 12:00:00"),
tz = "GMT"),
a = c(850, 850, 1100, 1100,1100),
count = c(1, 0, 3, 2,1))
tab <- a_lookup_fn(df)
d <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
devtools::load_all(".")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
devtools::load_all(".")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
devtools::load_all(".")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
devtools::load_all(".")
ste_data_fn(df,
count_col = "count",
samp = 3600,
samp_length = 10,
cam_areas = tab,
date_lim = d,
A = 150000)
df
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
library(devtools)
library(roxygen2)
library(usethis)
?usethis
?use_r
use_r("tte_data_fn.R")
libary(usethis)
library(usethis)
library(devtools)
library(roxygen2)
use_r("new")
library(devtools)
library(usethis)
library(roxygen2)
library(TTE.STE.IS)
browseVignettes("TTE.STE.IS")
?expand.grid
?dplyr::group_by
?dplyr::join
??spread
devtools::build_vignettes()
devtools::load_all(".")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
install.packages("mvtnorm")
install.packages("mvtnorm")
library(installr)
uninstall.packages("TTE.STE.IS")
library(TTE.STE.IS)
devtools::load_all(".")
devtools::build_vignettes()
library(roxygen2)
devtools::use_vignette("tte.ste.is")
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
devtools::build_vignettes("Using TTE.STE.IS")
devtools::use_vignettes("Using TTE.STE.IS")
library(devtools)
devtools::use_vignette("Using TTE.STE.IS")
devtools::build_vignettes()
library(TTE.STE.IS)
?ste_data_fn
devtools::build_vignettes()
devtools::build_vignettes()
head(df)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
head(df)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(x = dat,
count_col = "count",
samp_freq = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(TTE.STE.IS)
dat <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
lu <- a_lookup_fn(dat)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(x = dat,
count_col = "count",
samp_freq = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
usethis::use_vignette()
usethis::build_vignette()
usethis::use_vignette("tte.ste.is")
devtools::load_all(".")
?ste_data_fn
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
lu <- a_lookup_fn(df)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(df,
count_col = "count",
samp_freq = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(df,
count_col = "count",
samp_freq = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
devtools::load_all(".")
dates <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
dat.ste <- ste_data_fn(df,
count_col = "count",
samp_freq = 3600,
samp_length = 10,
cam_areas = lu,
date_lim = dates,
A = 150000)
dat.ste
usethis::use_vignette("tte.ste.is")
devtools::build_vignettes("tte.ste.is")
devtools::load_all(".")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
install.packages("purrr")
devtools::install_github("annam21/TTE.STE.IS", build_opts = c("--no-resave-data", "--no-manual"), force = T)
browseVignettes("TTE.STE.IS")
devtools::load_all(".")
devtools::build_vignettes()
devtools::load_all(".")
df <- data.frame(cam = c(1,1,2,2),
datetime = as.POSIXct(c("2016-01-02 12:00:00",
"2016-01-03 13:12:00",
"2016-01-02 14:00:00",
"2016-01-03 16:53:42"),
tz = "GMT"),
a = c(850, 850, 1100, 1100),
count = c(1, 0, 0, 2))
tab <- a_lookup_fn(df)
d <- as.POSIXct(c("2016-01-01 00:00:00", "2016-01-04 23:59:59"), tz = "GMT")
x=df
count_col = "count"
samp_freq = 3600
samp_length = 10
cam_areas = tab
date_lim = d
A = 150000
# Make sure time zones match
stopifnot(lubridate::tz(date_lim) == lubridate::tz(x$datetime))
# Create a vector of sampling start times
st <- sampling_start(samp_freq = samp_freq,
date_lim = date_lim)
# Find pictures WITH animals that are actually in a sampling period
tmp <- x %>%
dplyr::ungroup() %>% # safeguard for incoming data
dplyr::mutate(timer = diff_fn(datetime, st, interval_length = samp_length),
timer = as.POSIXct(timer, origin = "1970-01-01 00:00:00",
tz = lubridate::tz(x$datetime)) ) %>%
dplyr::filter(!is.na(timer),
!!as.name(count_col) > 0 ) %>% # where count > 0
dplyr::mutate(event = as.numeric(as.factor(.$timer))) # Give each event a number
# For events WITH a picture, find the space-to-event
out <- data.frame(datetime = as.POSIXct(NA),
areatoevent = NA)
if(nrow(tmp) >0){
for(i in 1:length(unique(tmp$event))){
cc <- sample(cam_areas$cam, length(cam_areas$cam), replace = F)
tmp2 <- tmp %>%
dplyr::filter(event == i) %>%
dplyr::rowwise() %>%
dplyr::mutate(camtoevent = which(cc == cam)) %>%
dplyr::ungroup() %>%
dplyr::group_by(event) %>%
dplyr::summarise(camtoevent = min(camtoevent),
datetime = dplyr::first(datetime)) %>%
dplyr::mutate(areatoevent = sum(cam_areas$a[1:camtoevent]) ) %>%
dplyr::select(datetime, areatoevent)
out[i,] <- tmp2
}
} else {
warning("No animals detected in any sampling occasion")
out <- NULL
}
# For events WITHOUT a picture, add in an NA
idf <- data.frame("datetime" = st)
toevent <- idf %>%
dplyr::anti_join(., tmp, by = c("datetime" = "timer")) %>%
dplyr::mutate(areatoevent = NA) %>%
dplyr::bind_rows(., out) %>%
dplyr::arrange(datetime) %>%
tidyr::spread(datetime, areatoevent) %>%
dplyr::select(-toevent) %>%
as.matrix()
idf %>%
dplyr::anti_join(., tmp, by = c("datetime" = "timer"))
idf %>%
dplyr::anti_join(., tmp, by = c("datetime" = "timer")) %>%
dplyr::mutate(areatoevent = NA) %>%
dplyr::bind_rows(., out)
idf %>%
dplyr::anti_join(., tmp, by = c("datetime" = "timer")) %>%
dplyr::mutate(areatoevent = NA) %>%
dplyr::bind_rows(., out) %>%
dplyr::arrange(datetime)
idf %>%
dplyr::anti_join(., tmp, by = c("datetime" = "timer")) %>%
dplyr::mutate(areatoevent = NA) %>%
dplyr::bind_rows(., out) %>%
dplyr::arrange(datetime) %>%
tidyr::spread(datetime, areatoevent)
tmp
devtools::build_vignettes()
